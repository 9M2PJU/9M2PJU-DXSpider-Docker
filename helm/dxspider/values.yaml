# Default values for dxspider.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# =============================================================================
# Image Configuration
# =============================================================================
image:
  # Image repository
  repository: 9m2pju/dxspider
  # Image pull policy
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion
  tag: "latest"

# Image pull secrets for private registries
imagePullSecrets: []

# =============================================================================
# DXSpider Cluster Configuration
# =============================================================================
cluster:
  # Node callsign (will be converted to uppercase)
  # Example: 9M2PJU-10, K1ABC-2, etc.
  callsign: "9M2PJU-10"

  # DXSpider git branch to use (mojo or master)
  branch: "mojo"

  # Geographic location
  location:
    # Latitude in decimal degrees (e.g., +51.5 for north, -33.8 for south)
    latitude: "+51.5"
    # Longitude in decimal degrees (e.g., -0.13 for west, +151.2 for east)
    longitude: "-0.13"
    # Maidenhead grid locator (6-character, will be converted to uppercase)
    locator: "OJ03UD"
    # QTH (location description)
    qth: "Kuala Lumpur, Malaysia"

  # Network configuration
  network:
    # Hostname for this node (FQDN)
    hostname: "dxspider.example.com"
    # Telnet port for DX Cluster clients
    port: 7300
    # Web console port for sysop access
    sysopPort: 8050
    # Metrics port for Prometheus
    metricsPort: 9100

# =============================================================================
# Sysop (System Operator) Configuration
# =============================================================================
sysop:
  # Sysop name
  name: "Piju"
  # Sysop callsign (will be converted to uppercase)
  callsign: "9M2PJU"
  # Sysop email address
  email: "9m2pju@hamradio.my"
  # BBS address (optional)
  bbs_address: ""
  # Sysop password for web console (stored in secret)
  # If empty, a random password will be generated
  password: ""

# =============================================================================
# Database Configuration (Optional)
# =============================================================================
database:
  # Enable database support
  enabled: false

  # Database connection settings
  # Only used if enabled: true
  type: "mysql"
  hostname: "mariadb"
  port: 3306
  name: "dxspider"
  user: "sysop"
  # Password stored in secret
  password: "sysoppassword"
  # Root password (only for bundled MariaDB)
  rootPassword: "rootpassword"

# =============================================================================
# DXSpider Configuration Files
# =============================================================================
config:
  # Startup commands (executed when DXSpider starts)
  startup: |
    load/forward
    set/spider 9m2pju-2
    connect 9m2pju-2

  # Crontab for scheduled tasks (DXSpider format)
  crontab: |
    0,5,10,20,30,40,50 * * * * start_connect('9m2pju-2') unless connected('9m2pju-2')

  # Message of the Day (displayed to connecting users)
  motd: |
             _   .-')               _ (`-.
             ( '.( OO )_            ( (OO  )
      .----.  ,--.   ,--.).-----.  _.`     \     ,--. ,--. ,--.
     /  ,.  \ |   `.'   |/ ,-.   \(__...--'' .-')| ,| |  | |  |
    |  |  \  ||         |'-'  |  | |  /  | |( OO |(_| |  | | .-')
     '  `-'  '|  |'.'|  |   .'  /  |  |_.' || `-'|  | |  |_|( OO )
      `- /  ' |  |   |  | .'  /__  |  .___.',--. |  | |  | | `-' /
       ,'  /  |  |   |  ||       | |  |     |  '-'  /('  '-'(_.-'
      `---'   `--'   `--'`-------' `--'      `-----'   `-----'
    WELCOME TO THE DX SPIDER NODE!

    This node provides real-time DX spotting information to amateur radio operators worldwide.

    For more information, visit https://hamradio.my

  # Partner node connections (key: callsign, value: connection script)
  # Example:
  # connections:
  #   9m2pju-2: |
  #     timeout 15
  #     connect telnet dx.example.com 7300
  #     'login:' '9M2PJU-10'
  connections: {}

# =============================================================================
# Resource Configuration
# =============================================================================
resources:
  # Resource limits
  limits:
    cpu: 2000m
    memory: 512Mi
  # Resource requests
  requests:
    cpu: 250m
    memory: 128Mi

# =============================================================================
# Persistence Configuration
# =============================================================================
persistence:
  # Enable persistent storage for runtime data
  enabled: true

  # Existing claim (if using pre-created PVC)
  existingClaim: ""

  # Storage class name
  # Use "-" for default storage class
  # Leave empty to let cluster choose
  storageClass: ""

  # Access mode
  accessMode: ReadWriteOnce

  # Storage size
  size: 10Gi

  # Additional volume annotations
  annotations: {}

  # Mount path in container
  mountPath: /spider/local_data

# =============================================================================
# Service Configuration
# =============================================================================
service:
  # Service type (ClusterIP, NodePort, LoadBalancer)
  type: ClusterIP

  # Telnet service configuration
  telnet:
    port: 7300
    # NodePort (only for type: NodePort)
    nodePort: null
    # Additional annotations
    annotations: {}

  # Web console service configuration
  console:
    port: 8050
    nodePort: null
    annotations: {}

  # Metrics service configuration
  metrics:
    port: 9100
    nodePort: null
    annotations: {}

  # Load balancer IP (only for type: LoadBalancer)
  loadBalancerIP: ""

  # Load balancer source ranges
  loadBalancerSourceRanges: []

# =============================================================================
# Ingress Configuration
# =============================================================================
ingress:
  # Enable ingress
  enabled: false

  # Ingress class name (nginx, traefik, etc.)
  className: "nginx"

  # Ingress annotations
  annotations: {}
    # cert-manager.io/cluster-issuer: letsencrypt-prod
    # nginx.ingress.kubernetes.io/ssl-redirect: "true"
    # traefik.ingress.kubernetes.io/router.tls: "true"

  # Ingress hosts
  hosts:
    - host: dxspider.example.com
      paths:
        - path: /console
          pathType: Prefix
          service: console
        - path: /metrics
          pathType: Prefix
          service: metrics

  # TLS configuration
  tls: []
    # - secretName: dxspider-tls
    #   hosts:
    #     - dxspider.example.com

# =============================================================================
# Metrics and Monitoring
# =============================================================================
metrics:
  # Enable metrics endpoint
  enabled: false

  # ServiceMonitor for Prometheus Operator
  serviceMonitor:
    # Create ServiceMonitor resource
    enabled: false

    # Additional labels for ServiceMonitor
    additionalLabels: {}
      # prometheus: kube-prometheus

    # Scrape interval
    interval: 30s

    # Scrape timeout
    scrapeTimeout: 10s

    # Namespace for ServiceMonitor (defaults to release namespace)
    namespace: ""

    # Relabeling configurations
    relabelings: []

    # Metric relabeling configurations
    metricRelabelings: []

# =============================================================================
# Pod Configuration
# =============================================================================
podAnnotations: {}

podSecurityContext:
  fsGroup: 1000
  runAsNonRoot: true
  runAsUser: 1000

securityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: false

# =============================================================================
# Health Checks
# =============================================================================
healthcheck:
  # Liveness probe
  livenessProbe:
    enabled: true
    exec:
      command:
        - /bin/sh
        - -c
        - nc -z localhost 7300 && pgrep -f cluster.pl > /dev/null
    initialDelaySeconds: 30
    periodSeconds: 30
    timeoutSeconds: 10
    failureThreshold: 3
    successThreshold: 1

  # Readiness probe
  readinessProbe:
    enabled: true
    exec:
      command:
        - /bin/sh
        - -c
        - nc -z localhost 7300
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
    successThreshold: 1

  # Startup probe
  startupProbe:
    enabled: true
    exec:
      command:
        - /bin/sh
        - -c
        - nc -z localhost 7300
    initialDelaySeconds: 0
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 30
    successThreshold: 1

# =============================================================================
# StatefulSet Configuration
# =============================================================================
statefulset:
  # Update strategy
  updateStrategy:
    type: RollingUpdate

  # Pod management policy
  podManagementPolicy: OrderedReady

  # Service name
  serviceName: dxspider

  # Termination grace period
  terminationGracePeriodSeconds: 30

# =============================================================================
# Node Selection
# =============================================================================
nodeSelector: {}

tolerations: []

affinity: {}

# =============================================================================
# Priority and Scheduling
# =============================================================================
priorityClassName: ""

# =============================================================================
# Additional Configuration
# =============================================================================
# Override name
nameOverride: ""

# Override fullname
fullnameOverride: ""

# Service account
serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# Additional environment variables
extraEnv: []
  # - name: CUSTOM_VAR
  #   value: "custom_value"

# Additional volumes
extraVolumes: []
  # - name: custom-volume
  #   configMap:
  #     name: custom-config

# Additional volume mounts
extraVolumeMounts: []
  # - name: custom-volume
  #   mountPath: /custom/path

# Additional init containers
initContainers: []

# Additional sidecar containers
sidecars: []
